<div class="profile-edit-panel">
    <div class="profile-edit-accordion">
        <button class="accordion-toggle" (click)="showUserForm = !showUserForm">
            <span>Editar datos</span>
            <span [class.rotated]="showUserForm">▼</span>
        </button>
        @if (showUserForm) {
            <form [formGroup]="changeUserForm" (ngSubmit)="changeUser()" class="edit-form">
                <div class="mb-3">
                    <label>Nombre</label>
                    <input type="text" class="form-control input" formControlName="name" />
                </div>
                <div class="mb-3">
                    <label>Bio</label>
                    <input type="text" class="form-control input" formControlName="bio" />
                </div>
                <button type="submit" class="btn btn-primary" [disabled]="changeUserForm.invalid">Guardar</button>
            </form>
        }
    </div>
    <button class="accordion-toggle" (click)="showEmailForm = !showEmailForm">
        <span>Cambiar email</span>
        <span [class.rotated]="showEmailForm">▼</span>
    </button>
    @if (showEmailForm) {
        <form [formGroup]="changeEmailForm" (ngSubmit)="changeEmail()" class="edit-form mt-3">
            <div class="mb-3">
                <label>Email</label>
                <input type="email" class="form-control input" formControlName="email" />
            </div>
            <div class="mb-3">
                <label>Repite email</label>
                <input type="email" class="form-control input" formControlName="email2" />
            </div>
            <button type="submit" class="btn btn-primary" [disabled]="changeEmailForm.invalid">Cambiar email</button>
        </form>
    }
    <button class="accordion-toggle" (click)="showPasswordForm = !showPasswordForm">
        <span>Cambiar contraseña</span>
        <span [class.rotated]="showPasswordForm">▼</span>
    </button>
    @if (showPasswordForm) {
        <form [formGroup]="changePasswordForm" (ngSubmit)="changePassword()" class="edit-form mt-3">
            <div class="mb-3">
                <label>Nueva contraseña</label>
                <input type="password" class="form-control input" formControlName="password" />
            </div>
            <div class="mb-3">
                <label>Repite contraseña</label>
                <input type="password" class="form-control input" formControlName="password2" />
            </div>
            <button type="submit" class="btn btn-primary" [disabled]="changePasswordForm.invalid">Cambiar contraseña</button>
        </form>
    }
    <button class="accordion-toggle" (click)="showAvatarForm = !showAvatarForm">
        <span>Cambiar avatar</span>
        <span [class.rotated]="showAvatarForm">▼</span>
    </button>
    @if (showAvatarForm) {
        <form [formGroup]="changeAvatarForm" (ngSubmit)="changeAvatar()" class="edit-form mt-3">
            <div class="mb-3">
                <label>Nuevo avatar</label>
                <input type="file" class="form-control input" (change)="onAvatarFileChange($event)" />
                @if (avatarBase64Arr.length > 0) {
                    <div class="img-preview-container">
                        <img [src]="avatarBase64Arr[0]" class="img-preview" alt="Avatar preview" />
                    </div>
                }
            </div>
            <button type="submit" class="btn btn-primary" [disabled]="changeAvatarForm.invalid || !avatarBase64Arr.length">Guardar avatar</button>
        </form>
    }
    <button class="accordion-toggle" (click)="showHeaderForm = !showHeaderForm">
        <span>Cambiar portada</span>
        <span [class.rotated]="showHeaderForm">▼</span>
    </button>
    @if (showHeaderForm) {
        <form [formGroup]="changeHeaderForm" (ngSubmit)="changeHeader()" class="edit-form mt-3">
            <div class="mb-3">
                <label>Nueva portada</label>
                <input type="file" class="form-control input" (change)="onHeaderFileChange($event)" />
                @if (headerBase64Arr.length > 0) {
                    <div class="img-preview-container">
                        <img [src]="headerBase64Arr[0]" class="img-preview header-preview" alt="Header preview" />
                    </div>
                }
            </div>
            <button type="submit" class="btn btn-primary" [disabled]="changeHeaderForm.invalid || !headerBase64Arr.length">Guardar portada</button>
        </form>
    }
</div>
