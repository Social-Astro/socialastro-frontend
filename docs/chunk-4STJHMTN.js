import{c as a,f as u}from"./chunk-FWI7O2YG.js";import{M as l,S as i,j as n,ma as m,n as r,v as s}from"./chunk-W4ZOI5UP.js";var c=e=>{if(typeof e!="object"||e===null)return!1;let t=e;return typeof t.id=="number"&&typeof t.name=="string"&&(typeof t.avatar=="string"||t.avatar===null)&&(typeof t.heading=="string"||t.heading===null)&&(typeof t.bio=="string"||t.bio===null)&&(typeof t.numLikes=="number"||t.numLikes===null)&&(typeof t.numPosts=="number"||t.numPosts===null)&&(typeof t.numFriends=="number"||t.numFriends===null)&&(typeof t.numComments=="number"||t.numComments===null)&&(typeof t.numAchievements=="number"||t.numAchievements===null)&&typeof t.role=="string"},g=e=>{if(!c(e))throw console.error("Invalid user data:",e),new TypeError("Invalid user data");return{id:e.id!==null?Number(e.id):null,name:e.name,email:e.email,avatar:e.avatar,heading:e.heading,bio:e.bio,numLikes:e.numLikes!==null?Number(e.numLikes):null,numPosts:e.numPosts!==null?Number(e.numPosts):null,numFriends:e.numFriends!==null?Number(e.numFriends):null,numComments:e.numComments!==null?Number(e.numComments):null,numAchievements:e.numAchievements!==null?Number(e.numAchievements):null,role:e.role}};var p=class e{#t=i(a);#e=m(!1);#n=null;get logged(){return this.#e.asReadonly()}constructor(){this.isLogged()}login(t){return this.#t.post("auth/login",t).pipe(r(o=>{localStorage.setItem("token",o.accessToken),this.#e.set(!0)}))}logout(){this.#e.set(!1),localStorage.clear()}isLogged(){return console.log(localStorage.getItem("token"),this.#e()),!this.#e()&&!localStorage.getItem("token")?n(!1):this.#e()&&localStorage.getItem("token")?n(!0):localStorage.getItem("token")?!this.#e()&&localStorage.getItem("token")?this.#t.get("auth/validate").pipe(r(()=>(this.#e.set(!0),!0)),s(()=>(localStorage.removeItem("token"),n(!1)))):n(!0):n(!1)}currentUser=u(()=>this.#e()?"users/me":void 0,{parse:g});register(t){return this.#t.post("auth/register",t)}static \u0275fac=function(o){return new(o||e)};static \u0275prov=l({token:e,factory:e.\u0275fac,providedIn:"root"})};export{g as a,p as b};
